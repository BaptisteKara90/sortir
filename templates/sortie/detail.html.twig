{% extends 'base.html.twig' %}
{% block javascript %}
{% block importmap %}{{ importmap('modal') }}{% endblock %}
{% endblock %}

{% block title %}{{ sortie.nom }}{% endblock %}

{% block body %}
    <h1>Détail de la sortie : {{ sortie.nom }}</h1>

    <div>
        <div>
            <ul>
                <li>Nom de la sortie : {{ sortie.nom }} </li>
                <li>Date et heure de la sortie : {{ sortie.debut|date("d/m/Y") }} </li>
                <li>Date limite d'inscription : {{ sortie.dateLimitInscription|date("d/m/Y") }} </li>
                <li>Nombre de place : {{ sortie.nbMaxParticipant }} </li>
                <li>Durée : {{ sortie.duree }} </li>
                <li>Description et infos : {{ sortie.infosSortie }} </li>
            </ul>
        </div>
        <div>
            <ul>
                <li>Lieu : {{ sortie.lieu.nom }} </li>
                <li>Rue : {{ sortie.lieu.rue }}</li>
                <li>Ville : {{ sortie.lieu.ville.nom }} </li>
                <li>Code postal : {{ sortie.lieu.ville.codePostal }} </li>
                <li>Lattitude : {{ sortie.lieu.lattitude }} </li>
                <li>Longitude : {{ sortie.lieu.longitude }} </li>
                {% if sortie.raison %}
                    <li>
                        Raison de l'annulation : {{ sortie.raison }}
                    </li>
                {% endif %}
                <li>
                    {% if app.user in sortie.participants %}
                        <a href="{{ path("sortie_quit", {"id": sortie.id}) }}">
                            <button>Se désinscrire</button>
                        </a>
                    {% else %}
                        {% if sortie.etat.libelle == "Ouverte" %}
                            <a href="{{ path("sortie_join", {"id": sortie.id}) }}">
                                S'inscrire
                            </a>
                        {% endif %}
                    {% endif %}
                </li>
                {% if sortie.organisateur.id == app.user.id and sortie.etat.id != 6 %}
                    <li>
                    <a id="cancel" href="">Annuler</a>
                    </li>

                    <!-- MODAL -->
                    <div class="modal-overlay" id="modalOverlay">
                        <div class="modal">
                            <h2>Annulation de la Sortie</h2>
                            <form action="{{ path('sortie_cancel', {'id': sortie.id }) }}" method="POST">
                                <div class="input-modal">
                                    <label for="raison">Veuillez indiquer la raison de l'annulation</label>
                                    <textarea name="raison" rows="3"></textarea>
                                </div>

                                <div>
                                    <input type="submit" value="Annuler la sortie"/>
                                </div>
                            </form>
                            <button id="closeModalButton">Précédent</button>
                        </div>
                    </div>
                {% endif %}
            </ul>
        </div>
    </div>
    <div>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Nom</th>
                </tr>
            </thead>
            <tbody>
            {% for participant in sortie.participants %}
                <tr>
                    <td>-</td>
                    <td><a href="{{ path('user_detail', {'id': participant.id }) }}">{{ participant.prenom }} {{ participant.nom }} </a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}


